(this.webpackJsonpadmin=this.webpackJsonpadmin||[]).push([[257],{1132:function(e,t,a){"use strict";a.r(t);var r=a(1),o=a(0),n=a(4),s=a(78);function c(e){return Object(r.jsxs)(s.a,Object(n.a)(Object(n.a)({},e),{},{children:[Object(r.jsx)("path",{d:"M5.48,14.94,12,5.1a5,5,0,0,1,4.21-2.27h2.75V1.51A.69.69,0,0,1,20.05,1L23.7,4.22a.77.77,0,0,1,0,1.17L20.05,8.62a.69.69,0,0,1-1.14-.52V6.78h-.79A5.08,5.08,0,0,0,13.9,9.05L7.44,18.89a5,5,0,0,1-4.21,2.27H.9a.9.9,0,0,1-.9-.9V18.09a.87.87,0,0,1,.88-.88h.39A5,5,0,0,0,5.48,14.94Z"}),Object(r.jsx)("path",{d:"M13.39,14.16l.51.79a5.08,5.08,0,0,0,4.22,2.27h.79V15.9a.69.69,0,0,1,1.14-.52l3.65,3.23a.77.77,0,0,1,0,1.17L20.05,23a.69.69,0,0,1-1.14-.52V21.17H16.16A5,5,0,0,1,12,18.9l-1.13-1.71a.62.62,0,0,1,0-.68l1.52-2.35A.63.63,0,0,1,13.39,14.16Z"}),Object(r.jsx)("path",{d:"M8.57,6.82,7.44,5.11A5,5,0,0,0,3.23,2.84H.9a.9.9,0,0,0-.9.9V5.91a.87.87,0,0,0,.88.88h.39A5,5,0,0,1,5.48,9.06l.52.8a.63.63,0,0,0,1,0L8.57,7.51A.66.66,0,0,0,8.57,6.82Z"})]}))}var i=a(19),p=a(8),u=a(14),_=a(93),l=a(962),d=a(468),f=a(92),b=a(470),y=a(86),v=a(29),m=a(205),j=["namespace","name","description","event","translator","custom_data_type","data_type_scope","scope_filter","scope_evaluator","lot_size","webhook","authorization","connection_role","before_submit","response_translator","response_data_type","discard_events","notify_request","notify_response","active","auto_retry","after_process_callbacks"],O=["All","Evaluator"],h=["namespace","name","description","translator","custom_data_type","data_type_scope","scope_filter","scope_evaluator","lot_size","webhook","before_submit","response_translator","response_data_type","after_process_callbacks"].reduce((function(e,t){return(e[t]=!0)&&e}),{});var g=a(472),V=a(1185),E=["namespace","name","description","event","translator","custom_data_type","data_type_scope","scope_filter","scope_evaluator","lot_size","webhook","authorization","connection_role","before_submit","response_translator","response_data_type","discard_events","notify_request","notify_response","active","auto_retry","after_process_callbacks"];t.default={title:"Flow",icon:Object(r.jsx)(c,{}),actions:{index:{fields:["namespace","name","description","active","event","translator","updated_at"]},new:{fields:E},edit:{viewportFields:[].concat(E,["origin"])}},formControl:function(e){var t=e.errors,a=e.value,s=e.propertyControlProps,c=e.properties,g=e.controlConfig,V=e.dynamicConfigState,E=e.readOnly,k=Object(u.a)({formValue:{},webhook:{editDisabled:!0}}),x=Object(p.a)(k,2),z=x[0],w=x[1],A=Object(u.a)(j.reduce((function(e,t,a){return e[t]=4<a&&a<19,e}),{})),C=Object(p.a)(A,2),I=C[0],q=C[1],D=Object(o.useRef)({}),F=z.formValue,L=z.loading,S=F.event,P=F.translator,H=F.custom_data_type,M=F.data_type_scope,R=F.response_translator,T=Object(o.useCallback)((function(e){var t=a.get();if(t[e]){var r=c.find((function(t){return t.name===e}));if(r)return r.isSimple().pipe(Object(_.a)((function(a){var o;if(a)return Object(f.a)(t[e]);var n=t[e].id;return(null===(o=D.current[e])||void 0===o?void 0:o.id)!==n?r.dataType.get(n).pipe(Object(l.a)((function(t){return D.current[e]={id:n,value:t}}))):Object(f.a)(D.current[e].value)})))}return Object(f.a)(null)}),[c,a]);Object(o.useEffect)((function(){var e=a.changed().pipe(Object(d.a)((function(){return Object(b.a)(100)}))).subscribe((function(e){return w({formValue:e})}));return function(){return e.unsubscribe()}}),[a]),Object(o.useEffect)((function(){if(P){w({loading:!0});var e=Object(v.a)(T("event"),T("translator")).subscribe((function(e){var t,r,o=Object(p.a)(e,2),n=o[0],s=o[1],c=s.type,u=s.source_data_type,_=s.target_data_type,l=a.get().custom_data_type;if(("Export"===c||"Conversion"===c)&&(r=u)||("Import"===c||"Update"===c)&&(r=_)?a.cache.custom_data_type&&(a.propertyValue("custom_data_type").delete(),t=!0,a.propertyValue("data_type_scope").delete(),q({custom_data_type:!0,data_type_scope:!0})):(q({custom_data_type:!1}),l||(a.propertyValue("custom_data_type").set(null===n||void 0===n?void 0:n.data_type,!0),t=!0)),!t){var d=a.propertyValue("data_type_scope");if("Import"===c)q({data_type_scope:!0}),d.delete();else{var f;q({data_type_scope:!1});var b=O;!(null===n||void 0===n?void 0:n.data_type)||(null===(f=r)||void 0===f?void 0:f.id)!==n.data_type.id&&(null===l||void 0===l?void 0:l.id)!==n.data_type.id||(b=["Event source"].concat(Object(i.a)(b))),(r||l)&&(b=[].concat(Object(i.a)(b),["Filter"])),w({data_type_scope:{options:b,title:"Update"===c?"Target scope":"Source scope"}}),-1===b.indexOf(d.get())&&d.deleteAndNotify()}}w({custom_data_type:{title:"Update"===c||"Import"===c?"Target data type":"Source data type"},loading:!1})}));return function(){return e.unsubscribe()}}a.propertyValue("custom_data_type").delete(),a.propertyValue("data_type_scope").delete(),q({custom_data_type:!0,data_type_scope:!0})}),[S,P,H,a,T]),Object(o.useEffect)((function(){var e=T("translator").subscribe((function(e){var t={scope_filter:"Filter"!==M,scope_evaluator:"Evaluator"!==M,lot_size:!e||"Export"!==e.type||!M||"Event source"===M};Object.keys(t).forEach((function(e){return t[e]&&a.propertyValue(e).delete()})),q(t)}));return function(){return e.unsubscribe()}}),[a,T,M]),Object(o.useEffect)((function(){var e=T("translator").subscribe((function(e){var t=!e||"Export"!==e.type&&"Import"!==e.type,r=a.get().data_type_scope,o={lot_size:!e||"Export"!==e.type||!r||"Event source"===r,webhook:t,authorization:t,connection_role:t,before_submit:!e||"Import"!==e.type,response_translator:!e||"Export"!==e.type,notify_request:t,notify_response:t};Object.keys(o).forEach((function(e){return o[e]&&a.propertyValue(e).delete()})),q(o)}));return function(){return e.unsubscribe()}}),[a,T,P]),Object(o.useEffect)((function(){var e=T("response_translator").subscribe((function(e){var t={response_data_type:!e||"Import"!==e.type||e.target_data_type,discard_events:!e||"Import"!==e.type};t.response_data_type&&a.propertyValue("response_data_type").delete(),q(t)}));return function(){return e.unsubscribe()}}),[a,T,R]);var U=c.reduce((function(e,t){return(e[t.name]=t)&&e}),{}),Z=j.map((function(e){return!I[e]&&U[e]})).filter((function(e){return e})),B=a.get().origin,J=B&&"default"!==B;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(m.a,{errors:t,propertyControlProps:function(e){var t=Object(n.a)(Object(n.a)({},s(e)),z[e]);return!E&&J&&h[e]&&(t.disabled=!0),t},controlConfig:g,dynamicConfigState:V,properties:Z}),L&&Object(r.jsx)(y.a,{})]})},fields:{event:{controlProps:{editDisabled:!0}},translator:{controlProps:{editDisabled:!0}},data_type_scope:{control:g.a},scope_evaluator:{selector:V.c},before_submit:{selector:V.d},response_translator:{selector:{type:"Import"}},after_process_callbacks:{selector:V.c}},groups:{request_and_response:{activeByDefault:!0,title:"Request & Response",fields:["webhook","authorization","connection_role","before_submit","response_translator","response_data_type","discard_events","notify_request","notify_response"]},behavior:{activeByDefault:!0,fields:["active","auto_retry","after_process_callbacks"]}}}},1185:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return n})),a.d(t,"b",(function(){return s}));var r={parameters_size:1},o={parameters_size:{$gte:1}},n={$or:[{parameters_size:1},{parameters_size:2}]},s={parameters_size:2}}}]);