(this.webpackJsonpadmin=this.webpackJsonpadmin||[]).push([[211],{1017:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(18),o=n(4),i=n(8),c=n(19),d=(n(0),n(1171)),u=n(16),s=n(503),p=n(437),l=n(93),f=n(91),y=n(29),b=n(38),m=n(205),_=n(1165),g=n(10),v=n(92),j=n(97),O=n(1163),h=Symbol.for("json_mapping"),T="Match an existing ID to update a record",k=["id","filename","contentType"];var $=["namespace","name","source_data_type","target_data_type","discard_events","mapping"];t.default={title:"Mapping Converter",icon:Object(a.jsx)(d.a,{}),actions:{index:{fields:["namespace","name","source_data_type","target_data_type","discard_events","updated_at"]},new:{fields:$,seed:{mapping:{}}},edit:{viewportFields:[].concat($,["origin"])}},orchestrator:_.a.apply(void 0,$),dynamicConfig:function(e,t){var n,a=e.source_data_type,d=e.target_data_type;if((null===a||void 0===a?void 0:a.id)&&(null===d||void 0===d?void 0:d.id)){if(t.source_data_type_id!==a.id||t.target_data_type_id!==d.id)return Object(y.a)(u.b.getById(a.id),u.b.getById(d.id)).pipe(Object(l.a)((function(e){return y.a.apply(void 0,Object(c.a)(e.map((function(e){return Object(v.a)(e)}))).concat(Object(c.a)(e.map((function(e){return Object(m.c)(e)})))))})),Object(l.a)((function(e){var t=Object(i.a)(e,4),n=t[0],s=t[1],l=Object(i.a)(t[2],2)[1],m=Object(i.a)(t[3],2)[1];return Object(y.a)(y.a.apply(void 0,Object(c.a)(l.map((function(e){return e.isModel(!0)})))),y.a.apply(void 0,Object(c.a)(m.map((function(e){return e.isModel(!0)}))))).pipe(Object(f.a)((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];return[a,l.filter((function(e,t){return n[t]})),m.filter((function(e,t){return a[t]}))]})),Object(f.a)((function(e){var t=Object(i.a)(e,2),f=t[0],y=t[1],_={controlProps:{autoSuggest:{anchor:"{{",values:l.map((function(e){return e.name})),tail:"}}"}}},v=["$"].concat(Object(c.a)(y.map((function(e){return e.name})))),h={type:"object",properties:{source:{type:"string",enum:v,default:"$"},transformation:{referenced:!0,$ref:{namespace:"Setup",name:"Translator"}},options:{type:"string"}}},$={id:{type:"string",description:T}},x={fields:{id:{readOnly:!1,controlProps:_.controlProps}}};if(s._type===u.c)$={id:{type:"string",description:T},filename:{type:"string",title:"File name"},contentType:{title:"Content Type",type:"string"},data:{type:"object",label:"Data mapping",properties:{source:{type:"string",enum:v,default:"$"},transformation:{referenced:!0,$ref:{namespace:"Setup",name:"Template"}},options:{type:"string"}}}},k.forEach((function(e){return x.fields[e]=_})),x.fields.id={readOnly:!1},x.fields.data={controlProps:{fetched:!0,config:{fields:{source:{controlProps:{deleteDisabled:!0}},transformation:{title:"Template",typesFilter:function(e){return e.filter((function(e){return e.name.includes("Template")}))},newSeed:function(e,t){var a,r=e.parent.propertyValue("source").get();return{source_data_type:"$"===r?n:null===(a=l.find((function(e){return e.name===r})))||void 0===a?void 0:a.dataType}},formConfig:{fields:{source_data_type:{control:O.a}}},controlProps:{deleteDisabled:!0}}},dynamicConfig:function(e,t){var a=e.source;if(t.source_key!==a){var r,o,i,c,d={$or:[{source_data_type_id:(i="$"===a?n:(o=l.find((function(e){return e.name===a}))).dataType).id},{source_data_type_id:null},{source_data_type_id:{$exists:!1}}]};return(null===(r=o)||void 0===r?void 0:r.isTypeMany())?(c="Define the file data from a bulk source template for ".concat(i.name),d={$and:[d,{bulk_source:!0}]}):c="Define the file data from a template for ".concat(i.name),{source_key:a,transformation:{selector:d,description:c}}}}}}};else{m.forEach((function(e,t){var a=e.name;f[t]?($[a]=Object(o.a)({label:"".concat(Object(j.b)(a)," mapping")},h),x.fields[a]=function(e){return{controlProps:{fetched:!0,config:{fields:{source:{controlProps:{deleteDisabled:!0}},transformation:{typesFilter:function(e){return e.filter((function(e){var t=e.name;return t.includes("Template")||t.includes("Converter")}))},newSeed:function(t,a){var r,o,i,c,d,u,s=t.parent.propertyValue("source").get();return i=(i="$"===s?n:(o=l.find((function(e){return e.name===s}))).dataType).asRef(),a.name.includes("Template")&&(null===(r=o)||void 0===r?void 0:r.isTypeMany())&&!e.isTypeMany()&&(c=!0),a.name.includes("Converter")&&(d=e.dataType.asRef()),"RubyConverter"===a.name&&(u=!1),{source_data_type:i,target_data_type:d,source_handler:u,bulk_source:c}},formConfig:function(t,n){var a,r,o,i=n.parent.propertyValue("source").get();return"$"!==i&&(r=l.find((function(e){return e.name===i}))),t.name.includes("Template")&&(null===(a=r)||void 0===a?void 0:a.isTypeMany())&&!e.isTypeMany()&&(o={control:O.a}),{fields:{source_data_type:{control:O.a},target_data_type:{control:O.a},source_handler:{control:O.a},bulk_source:o}}},controlProps:{deleteDisabled:!0}}},dynamicConfig:function(t,a){var r=t.source;if(a.source_key!==r){var o,i,c,d;c="$"===r?n:(i=l.find((function(e){return e.name===r}))).dataType,(null===(o=i)||void 0===o?void 0:o.isTypeMany())&&!e.isTypeMany()&&(d=!0);var u={$or:[{type:"Export",source_data_type_id:"$oid#".concat(c.id),bulk_source:d},{type:"Export",source_data_type_id:null,bulk_source:d},{type:"Export",source_data_type_id:{$exists:!1},bulk_source:d},{type:"Conversion",source_data_type_id:"$oid#".concat(c.id),target_data_type_id:"$oid#".concat(e.dataType.id),source_handler:{$ne:!0}}]},s="Map ".concat(c.name," (from ").concat("$"===r?"source":r,") to ").concat(e.dataType.name," (").concat(e.name,")");return d&&(s+=" with a bulk source transformation",u={$and:[u,{bulk_source:!0}]}),{source_key:r,transformation:{selector:u,description:s}}}}}}}}(e)):"id"!==a&&"_id"!==a&&($[a]={type:"string"},x.fields[a]=_)}))}return{source_data_type_id:a.id,target_data_type_id:d.id,mapping:{key:b.a.string(),control:p.a,controlProps:{fetched:!0,dataType:u.b.from(Object(r.a)({name:"Mapping",schema:{type:"object",label:"Mapping",properties:$}},g.c,x))}}}})))})))}else if(!t.hasOwnProperty(h))return n={},Object(r.a)(n,h,!0),Object(r.a)(n,"mapping",{key:b.a.string(),control:s.a}),n}}},1163:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(1),r=n(8),o=n(0),i=n(14),c=n(52),d=n(64),u=n(471),s=n(3),p=Object(c.a)((function(e){return{root:{border:"solid 1px ".concat(e.palette.background.default)},title:{minHeight:e.spacing(7),background:e.palette.background.default,borderTopLeftRadius:e.spacing(.5),borderTopRightRadius:e.spacing(.5),alignItems:"center",padding:e.spacing(0,2)},content:{padding:e.spacing(2)}}}));function l(e){var t=e.title,n=e.value,c=e.property,l=e.config,f=Object(i.a)(),y=Object(r.a)(f,2),b=y[0],m=y[1],_=p();Object(o.useEffect)((function(){var e=n.parent.changed().subscribe((function(e){return m({item:e})}));return function(){return e.unsubscribe()}}),[n]);var g=b.item,v=l.viewer||Object(u.a)(c);return Object(a.jsxs)("div",{className:_.root,children:[Object(a.jsx)("div",{className:Object(s.default)("flex",_.title),children:Object(a.jsx)(d.a,{variant:"subtitle2",children:t})}),Object(a.jsx)("div",{className:Object(s.default)("flex justify-content-center",_.content),children:Object(a.jsx)(v,{prop:c,value:n.get(),item:g})})]})}},1165:function(e,t,n){"use strict";var a=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return function(t,a,r,o){var i=o.readOnly,c={};if(n.forEach((function(n){var r,o=!i&&Boolean(e(t,n));o!==Boolean(null===(r=a[n])||void 0===r?void 0:r.disabled)&&(c[n]={disabled:o})})),Object.keys(c).length)return c}};t.a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.apply(void 0,[function(e){var t=e.origin;return t&&"default"!==t}].concat(t))}},1171:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4),r=n(1),o=(n(0),n(78));function i(e){return Object(r.jsxs)(o.a,Object(a.a)(Object(a.a)({},e),{},{children:[Object(r.jsx)("path",{d:"M18.58,0H5.42A5.42,5.42,0,0,0,0,5.42V17.66A6.34,6.34,0,0,0,6.34,24h4.8a8.33,8.33,0,1,1,1.72,0h5.72A5.42,5.42,0,0,0,24,18.58V5.42A5.42,5.42,0,0,0,18.58,0Z"}),Object(r.jsx)("path",{d:"M12,8.88a6.83,6.83,0,1,0,6.83,6.83A6.84,6.84,0,0,0,12,8.88Z"})]}))}}}]);